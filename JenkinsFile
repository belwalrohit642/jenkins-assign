pipeline {
    agent any

    environment {
        // Specify the branch you want to check
        targetBranch = 'master'
    }

    stages {
        stage('Checkout') {
            steps {
                script {
                    checkout scm

                    // Check if the branch exists
                    if (branchExists(targetBranch)) {
                        echo "Branch ${targetBranch} exists in the repository."
                    } else {
                        error "Branch ${targetBranch} does not exist in the repository."
                    }
                }
            }
        }

    }
}

def branchExists(branch) {
    def remoteBranches = sh(script: 'git ls-remote --heads origin', returnStdout: true).trim().split('\n')

    // Check if the specified branch exists in the list of remote branches
    return remoteBranches.any { it.contains("refs/heads/${branch}") }
}

